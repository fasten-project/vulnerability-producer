{
  "url": "https://api.github.com/repos/uclouvain/openjpeg/issues/1044",
  "repository_url": "https://api.github.com/repos/uclouvain/openjpeg",
  "labels_url": "https://api.github.com/repos/uclouvain/openjpeg/issues/1044/labels{/name}",
  "comments_url": "https://api.github.com/repos/uclouvain/openjpeg/issues/1044/comments",
  "events_url": "https://api.github.com/repos/uclouvain/openjpeg/issues/1044/events",
  "html_url": "https://github.com/uclouvain/openjpeg/issues/1044",
  "id": 280398627,
  "node_id": "MDU6SXNzdWUyODAzOTg2Mjc=",
  "number": 1044,
  "title": "Similar vulnerable functions related to CVE-2017-14041",
  "user": {
    "login": "Young-X",
    "id": 4388415,
    "node_id": "MDQ6VXNlcjQzODg0MTU=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/4388415?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Young-X",
    "html_url": "https://github.com/Young-X",
    "followers_url": "https://api.github.com/users/Young-X/followers",
    "following_url": "https://api.github.com/users/Young-X/following{/other_user}",
    "gists_url": "https://api.github.com/users/Young-X/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Young-X/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Young-X/subscriptions",
    "organizations_url": "https://api.github.com/users/Young-X/orgs",
    "repos_url": "https://api.github.com/users/Young-X/repos",
    "events_url": "https://api.github.com/users/Young-X/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Young-X/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 1,
  "created_at": "2017-12-08T07:29:36Z",
  "updated_at": "2018-11-16T08:42:19Z",
  "closed_at": "2018-11-16T08:42:19Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "There are two functions similar to vulnerable function with id CVE-2017-14041 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14041](url) with issue id (#997 ).\r\n\r\nBelow is the patch for CVE-2017-14041.\r\n[https://github.com/uclouvain/openjpeg/commit/e5285319229a5d77bf316bb0d3a6cbd3cb8666d9](https://github.com/uclouvain/openjpeg/commit/e5285319229a5d77bf316bb0d3a6cbd3cb8666d9)\r\n![default](https://user-images.githubusercontent.com/4388415/33755274-f4b38672-dc2a-11e7-9cd6-18e0dd05e888.png)\r\n\r\nBelow are two functions that similar to the vulnerable function.\r\n1. src/bin/jp3d/convert.c (pgxtovolume)\r\n```\r\n    for (s = 0; s < sliceno; s++) {\r\n        int pos = maxslice == sliceno ? s : pgxslicepos[s];\r\n        f = fopen(pgxfiles[pos], \"rb\");\r\n        if (!f) {\r\n            fprintf(stdout, \"[ERROR] Failed to open %s for reading !\\n\", pgxfiles[s]);\r\n            return NULL;\r\n        }    \r\n        fprintf(stdout, \"[INFO] Loading %s \\n\", pgxfiles[pos]);\r\n\r\n        fseek(f, 0, SEEK_SET);\r\n        fscanf(f, \"PG%[ \\t]%c%c%[ \\t+-]%d%[ \\t]%d%[ \\t]%d\", temp, &endian1, &endian2,\r\n               signtmp, &prec, temp, &w, temp, &h); \r\n\r\n        i = 0; \r\n        sign = '+'; \r\n        while (signtmp[i] != '\\0') {\r\n            if (signtmp[i] == '-') {\r\n                sign = '-'; \r\n            }    \r\n            i++; \r\n        }\r\n```\r\n![default](https://user-images.githubusercontent.com/4388415/33755358-54c5b2d8-dc2b-11e7-9755-f3fe95d7d981.png)\r\n\r\n2. src/bin/jpwl/convert.c (pgxtoimage)\r\n\r\n```\r\n    fseek(f, 0, SEEK_SET);\r\n    if (fscanf(f, \"PG%[ \\t]%c%c%[ \\t+-]%d%[ \\t]%d%[ \\t]%d\", temp, &endian1,\r\n               &endian2, signtmp, &prec, temp, &w, temp, &h) != 9) { \r\n        fprintf(stderr,\r\n                \"ERROR: Failed to read the right number of element from the fscanf() function!\\n\");\r\n        fclose(f);\r\n        return NULL;\r\n    }\r\n```\r\n\r\n![default](https://user-images.githubusercontent.com/4388415/33755328-34b3a4dc-dc2b-11e7-96f2-30039f6551b7.png)\r\n\r\nI think there are vulnerabilities in those two functions, too. Therefore, there should be patches for those two functions.\r\n\r\n",
  "closed_by": {
    "login": "rouault",
    "id": 1192433,
    "node_id": "MDQ6VXNlcjExOTI0MzM=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/1192433?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rouault",
    "html_url": "https://github.com/rouault",
    "followers_url": "https://api.github.com/users/rouault/followers",
    "following_url": "https://api.github.com/users/rouault/following{/other_user}",
    "gists_url": "https://api.github.com/users/rouault/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rouault/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rouault/subscriptions",
    "organizations_url": "https://api.github.com/users/rouault/orgs",
    "repos_url": "https://api.github.com/users/rouault/repos",
    "events_url": "https://api.github.com/users/rouault/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rouault/received_events",
    "type": "User",
    "site_admin": false
  },
  "performed_via_github_app": null
}