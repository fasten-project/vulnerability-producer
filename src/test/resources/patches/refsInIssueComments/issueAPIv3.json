{
  "url": "https://api.github.com/repos/uclouvain/openjpeg/issues/1126",
  "repository_url": "https://api.github.com/repos/uclouvain/openjpeg",
  "labels_url": "https://api.github.com/repos/uclouvain/openjpeg/issues/1126/labels{/name}",
  "comments_url": "https://api.github.com/repos/uclouvain/openjpeg/issues/1126/comments",
  "events_url": "https://api.github.com/repos/uclouvain/openjpeg/issues/1126/events",
  "html_url": "https://github.com/uclouvain/openjpeg/issues/1126",
  "id": 344823827,
  "node_id": "MDU6SXNzdWUzNDQ4MjM4Mjc=",
  "number": 1126,
  "title": "Missing checks for header_info.height and header_info.width in function pnmtoimage in src/bin/jpwl/convert.c, which can lead to heap buffer overflow",
  "user": {
    "login": "Young-X",
    "id": 4388415,
    "node_id": "MDQ6VXNlcjQzODg0MTU=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/4388415?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Young-X",
    "html_url": "https://github.com/Young-X",
    "followers_url": "https://api.github.com/users/Young-X/followers",
    "following_url": "https://api.github.com/users/Young-X/following{/other_user}",
    "gists_url": "https://api.github.com/users/Young-X/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Young-X/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Young-X/subscriptions",
    "organizations_url": "https://api.github.com/users/Young-X/orgs",
    "repos_url": "https://api.github.com/users/Young-X/repos",
    "events_url": "https://api.github.com/users/Young-X/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Young-X/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 5,
  "created_at": "2018-07-26T12:31:16Z",
  "updated_at": "2019-03-29T10:42:46Z",
  "closed_at": "2019-03-29T10:42:46Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Function pnmtoimage in src/bin/jpwl/convert.c misses checks for header_info.height and header_info.width, which can lead to heap buffer overflow. (see #861 )\r\n\r\n```\r\n1856    memset(&header_info, 0, sizeof(struct pnm_header));\r\n1857\r\n1858    read_pnm_header(fp, &header_info);\r\n1859\r\n1860    if (!header_info.ok) {\r\n1861        fclose(fp);\r\n1862        return NULL;\r\n1863    }\r\n1864\r\n1865    format = header_info.format;\r\n```\r\n\r\nBelow is the proposal patch.\r\n```\r\n    memset(&header_info, 0, sizeof(struct pnm_header));\r\n\r\n    read_pnm_header(fp, &header_info);\r\n\r\n    if (!header_info.ok) {\r\n        fclose(fp);\r\n        return NULL;\r\n    }\r\n +    /* This limitation could be removed by making sure to use size_t below */\r\n +    if (header_info.height != 0 &&\r\n +            header_info.width > INT_MAX / header_info.height) {\r\n +        fprintf(stderr, \"pnmtoimage:Image %dx%d too big!\\n\",\r\n +                header_info.width, header_info.height);\r\n +        fclose(fp);\r\n +        return NULL;\r\n +    }\r\n +\r\n    format = header_info.format;\r\n```\r\n\r\n\r\n",
  "closed_by": {
    "login": "rouault",
    "id": 1192433,
    "node_id": "MDQ6VXNlcjExOTI0MzM=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/1192433?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rouault",
    "html_url": "https://github.com/rouault",
    "followers_url": "https://api.github.com/users/rouault/followers",
    "following_url": "https://api.github.com/users/rouault/following{/other_user}",
    "gists_url": "https://api.github.com/users/rouault/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rouault/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rouault/subscriptions",
    "organizations_url": "https://api.github.com/users/rouault/orgs",
    "repos_url": "https://api.github.com/users/rouault/repos",
    "events_url": "https://api.github.com/users/rouault/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rouault/received_events",
    "type": "User",
    "site_admin": false
  },
  "performed_via_github_app": null
}